function PID( handle, event)
persistent error_prev error u enc_init;
global robot x_cmd ei tp;
%input parameter
kp = 3;
kd = 2;
ki = 0.1;
current_enc = double(handle.LatestMessage.Left) / 1e3;
el_n = current_enc - enc_init;
t_now = double(handle.LatestMessage.Header.Stamp.Nsec) / 1e9;
error_prev = error;
if(tp == -1)
    tp = t_now;
else
    dt = t_now - tp;
    tp = t_now;
    if (el_n ~= 0) && (dt~=0) 
        if(dt < 0)
            dt = 1+t_now - rs_p.time;
        end
        error = (x_cmd - current_enc);

        max = .25;

        %Actual feed back loop
        ep = error *  kp;
        ed = ((error - error_prev) / dt) * kd; 
        ei = (ei + error * dt) * ki;
        u = ep + ed + ei;
        if u > max
            u = max;
        elseif u < -max
            u = -max;
        end

        if error <= .001
            u = 0;
        end
    end
    robot.sendVelocity(u,u);
end
end

